# 施設運営「チャレンジスペース」報告書作成システム

## 目次

1. [概要](#概要)  
2. [目的](#目的)  
3. [主な機能](#主な機能)  
4. [設定](#設定)  
5. [主な関数](#主な関数)  
6. [ファイル構成](#ファイル構成)

---

## 概要

このスクリプトは、Googleフォームの送信データをもとに、学生会館「チャレンジスペース」の利用報告書を自動で作成し、PDF化して管理者にメール送信するシステムである。効率的なファイル管理とメール連絡が可能となる。

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## 目的

1. 学生会館利用報告の作成を効率化する。  
2. 報告書作成から提出までの一連の作業を自動化する。  
3. 情報の正確性を保ち、関係者間でのスムーズな連携を実現する。  

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## 主な機能

1. **ドキュメント生成**  
   - Googleフォームの送信内容をもとに、テンプレートドキュメントをコピーして報告書を作成する。  
   - 動的に内容（サークル名、日付、目的など）を置換。

2. **Googleドライブでのファイル管理**  
   - 生成した報告書を新しいフォルダに保存。  
   - フォルダ名は「サークル名_終了日」の形式で作成。

3. **PDF変換とメール送信**  
   - 報告書をPDF形式でエクスポートし、管理者およびサークル代表者に送信。  
   - メールにはPDFを添付。

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## 設定

### 必要な環境

1. **Googleフォーム**  
   - チャレンジスペース利用報告のデータ収集用。  

2. **Googleドキュメントテンプレート**  
   - 報告書のテンプレートとして使用。  

3. **Googleドライブ**  
   - 生成されたファイルを管理・保存。  

4. **Google Apps Script**  
   - フォーム送信時のトリガーでスクリプトを実行。

### 設定箇所

1. **テンプレートドキュメントのID**
   ```javascript
   const templateDocId = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';
   ```
   ここに[テンプレートドキュメント](report_docs.pdf)の内容を反映させたドキュメントIDを挿入

2. **親フォルダのID**
   ```javascript
   const parentFolderId = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';
   ```

3. **送信先メールアドレス**
   ```javascript
   to: 'school@example';
   ```

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## 主な関数

### 1. `onFormSubmit(e)`
- **目的**: フォーム送信データをもとに報告書を作成・管理者に送信する。  
- **処理概要**:  
  1. フォームデータを取得し、各項目を変数に格納。  
  2. テンプレートドキュメントをコピーし、動的に内容を置換。  
  3. 新しいフォルダにドキュメントを保存し、PDFとしてエクスポート。  
  4. 管理者にメールで報告書を送信。

### 2. `DriveApp.createFolder()`
- **目的**: 指定された親フォルダ内に新しいフォルダを作成。  
- **処理概要**:  
  - フォルダ名を動的に生成（「サークル名_終了日」形式）。  
  - 生成したフォルダにファイルを整理。

### 3. `MailApp.sendEmail(options)`
- **目的**: 報告書を添付したメールを送信。  
- **処理概要**:  
  - メール本文に報告書の概要を記載。  
  - 添付ファイルとしてPDFを含む。

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## ファイル構成

.

├── report_README.md                              # 本ファイル

├── [report.js](report.js)     # コード

├── [report_docs.pdf](report_docs.pdf)   # テンプレートドキュメント

└── [report_form.xlsx](report_form.xlsx)  # フォームの内容を反映させたスプレッドシート(出力の関係でExcelファイルになっている。本来はスプレッドシートのデータ)

<p align="right">(<a href="#top">トップへ</a>)</p>
