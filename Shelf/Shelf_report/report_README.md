### Google Apps Script: 売店横の棚利用報告書作成システム

---

## 目次
1. [概要](#概要)  
2. [目的](#目的)  
3. [主な機能](#主な機能)  
4. [設定](#設定)  
5. [主な関数](#主な関数)  
6. [ファイル構成](#ファイル構成)  


---

## 概要
このGoogle Apps Scriptは、売店横の棚利用に関する報告書を自動作成し、メールで提出するためのツールである。利用者からのGoogleフォームの回答をもとにドキュメントを生成し、PDFとして提出用フォルダに格納する。

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## 目的
- サークルや団体による棚利用の報告プロセスを効率化する。
- 利用記録を簡単に作成し、学校側に迅速に提出することを可能にする。
- 利用情報のデジタル管理による作業の透明性向上と効率化を実現する。

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## 主な機能
1. **ドキュメントの自動生成**  
   - Googleフォームの回答内容をもとにテンプレートドキュメントを複製し、必要な情報を埋め込んで完成させる。

2. **PDFの自動作成と格納**  
   - 作成したドキュメントをPDFに変換し、特定のフォルダに保存する。

3. **メールの自動送信**  
   - 作成したPDFを添付し、報告書として学校側および関係者にメールで送信する。

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## 設定

### 必要な設定
1. **Googleドキュメントテンプレート**
   - 必要な情報が埋め込めるようにプレースホルダ（例: `{{申請日}}`）を設定したテンプレートを作成する。  

2. **Googleフォーム**
   - 必要な回答を収集するフォームを設置する。

3. **フォルダ構成**
   - PDF保存用の親フォルダを用意し、そのフォルダIDをスクリプトに設定する。

### 設定箇所
- **テンプレートドキュメントのID**
  ```javascript
  const templateDocId = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';
  ```
- **保存用フォルダのID**
  ```javascript
  const parentFolderId = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';
  ```

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## 主な関数

### 1. `onFormSubmit(e)`
- **目的**: Googleフォームの回答を受け取り、報告書を自動生成してメール送信する。
- **引数**: 
  - `e`: フォーム回答イベントオブジェクト。
- **機能**:
  - フォームの回答データを取得。
  - テンプレートドキュメントを複製し、必要な情報を埋め込む。
  - 作成したドキュメントをPDFに変換して保存。
  - PDFを添付した報告メールを自動送信。

<p align="right">(<a href="#top">トップへ</a>)</p>

---

## ファイル構成

.

├── report_README.md                              # 本ファイル

├── [report.js](report.js)     # コード

├── [report_docs.pdf](report_docs.pdf)   # テンプレートドキュメント

└── [report_form.xlsx](report_form.xlsx)  # フォームの内容を反映させたスプレッドシート(出力の関係でExcelファイルになっている。本来はスプレッドシートのデータ)

<p align="right">(<a href="#top">トップへ</a>)</p>
